{"remainingRequest":"C:\\SSAFY\\git\\s03p23b304\\fe_chat\\node_modules\\babel-loader\\lib\\index.js!C:\\SSAFY\\git\\s03p23b304\\fe_chat\\src\\store\\ChatModule.js","dependencies":[{"path":"C:\\SSAFY\\git\\s03p23b304\\fe_chat\\src\\store\\ChatModule.js","mtime":1600910340547},{"path":"C:\\SSAFY\\git\\s03p23b304\\fe_chat\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\SSAFY\\git\\s03p23b304\\fe_chat\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAqIGFzIGZpcmViYXNlIGZyb20gJ2ZpcmViYXNlJzsKdmFyIENoYXRNb2R1bGUgPSB7CiAgc3RhdGU6IHsKICAgIGNoYXRzOiB7fQogIH0sCiAgbXV0YXRpb25zOiB7CiAgICBzZXRDaGF0czogZnVuY3Rpb24gc2V0Q2hhdHMoc3RhdGUsIHBheWxvYWQpIHsKICAgICAgcGF5bG9hZFsiMCJdID0gewogICAgICAgIG5hbWU6ICJEZWZhdWx0IgogICAgICB9OwogICAgICBzdGF0ZS5jaGF0cyA9IHBheWxvYWQ7CiAgICB9CiAgfSwKICBhY3Rpb25zOiB7CiAgICBzZW5kTWVzc2FnZTogZnVuY3Rpb24gc2VuZE1lc3NhZ2UoY29udGV4dCwgcGF5bG9hZCkgewogICAgICB2YXIgY2hhdElEID0gcGF5bG9hZC5jaGF0SUQ7CiAgICAgIHZhciBtZXNzYWdlID0gewogICAgICAgIHVzZXI6IHBheWxvYWQudXNlcm5hbWUsCiAgICAgICAgY29udGVudDogcGF5bG9hZC5jb250ZW50LAogICAgICAgIGRhdGU6IHBheWxvYWQuZGF0ZQogICAgICB9OwogICAgICBmaXJlYmFzZS5kYXRhYmFzZSgpLnJlZignbWVzc2FnZXMnKS5jaGlsZChjaGF0SUQpLmNoaWxkKCdtZXNzYWdlcycpLnB1c2gobWVzc2FnZSkudGhlbihmdW5jdGlvbiAoZGF0YSkge30pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgfSk7CiAgICB9LAogICAgbG9hZFVzZXJDaGF0czogZnVuY3Rpb24gbG9hZFVzZXJDaGF0cyhjb250ZXh0KSB7CiAgICAgIHZhciB1c2VyID0gY29udGV4dC5nZXR0ZXJzLnVzZXI7CiAgICAgIGZpcmViYXNlLmRhdGFiYXNlKCkucmVmKCd1c2VycycpLmNoaWxkKHVzZXIuaWQpLmNoaWxkKCdjaGF0cycpLm9yZGVyQnlDaGlsZCgidGltZXN0YW1wIikub25jZSgidmFsdWUiLCBmdW5jdGlvbiAoc25hcHNob3QpIHsKICAgICAgICB2YXIgY2hhdHMgPSBzbmFwc2hvdC52YWwoKTsKCiAgICAgICAgaWYgKGNoYXRzID09IG51bGwpIHsKICAgICAgICAgIGNoYXRzID0ge307CiAgICAgICAgfQoKICAgICAgICB2YXIgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcChjaGF0SWQpIHsKICAgICAgICAgIGNoYXRzW2NoYXRJZF0ubmFtZSA9ICJMb2FkaW5nLi4uIjsKICAgICAgICAgIGZpcmViYXNlLmRhdGFiYXNlKCkucmVmKCdjaGF0cycpLmNoaWxkKGNoYXRJZCkub25jZSgndmFsdWUnLCBmdW5jdGlvbiAoc25hcHNob3QpIHsKICAgICAgICAgICAgY2hhdHNbY2hhdElkXS5uYW1lID0gc25hcHNob3QudmFsKCkubmFtZTsKICAgICAgICAgICAgY29udGV4dC5jb21taXQoJ3NldENoYXRzJywgY2hhdHMpOwogICAgICAgICAgfSk7CiAgICAgICAgfTsKCiAgICAgICAgZm9yICh2YXIgY2hhdElkIGluIGNoYXRzKSB7CiAgICAgICAgICBfbG9vcChjaGF0SWQpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwKICBnZXR0ZXJzOiB7CiAgICBjaGF0czogZnVuY3Rpb24gY2hhdHMoc3RhdGUpIHsKICAgICAgcmV0dXJuIHN0YXRlLmNoYXRzOwogICAgfQogIH0KfTsKZXhwb3J0IGRlZmF1bHQgQ2hhdE1vZHVsZTs="},{"version":3,"sources":["C:/SSAFY/git/s03p23b304/fe_chat/src/store/ChatModule.js"],"names":["firebase","ChatModule","state","chats","mutations","setChats","payload","name","actions","sendMessage","context","chatID","message","user","username","content","date","database","ref","child","push","then","data","catch","error","console","log","loadUserChats","getters","id","orderByChild","once","snapshot","val","chatId","commit"],"mappings":";AAAA,OAAO,KAAKA,QAAZ,MAA0B,UAA1B;AAEA,IAAMC,UAAU,GAAG;AACjBC,EAAAA,KAAK,EAAE;AACLC,IAAAA,KAAK,EAAE;AADF,GADU;AAIjBC,EAAAA,SAAS,EAAE;AACTC,IAAAA,QADS,oBACCH,KADD,EACQI,OADR,EACiB;AACxBA,MAAAA,OAAO,CAAC,GAAD,CAAP,GAAe;AAACC,QAAAA,IAAI,EAAE;AAAP,OAAf;AACAL,MAAAA,KAAK,CAACC,KAAN,GAAcG,OAAd;AACD;AAJQ,GAJM;AAUjBE,EAAAA,OAAO,EAAE;AACPC,IAAAA,WADO,uBACMC,OADN,EACeJ,OADf,EACwB;AAC7B,UAAIK,MAAM,GAAGL,OAAO,CAACK,MAArB;AACA,UAAMC,OAAO,GAAG;AACdC,QAAAA,IAAI,EAAEP,OAAO,CAACQ,QADA;AAEdC,QAAAA,OAAO,EAAET,OAAO,CAACS,OAFH;AAGdC,QAAAA,IAAI,EAAEV,OAAO,CAACU;AAHA,OAAhB;AAKAhB,MAAAA,QAAQ,CAACiB,QAAT,GAAoBC,GAApB,CAAwB,UAAxB,EAAoCC,KAApC,CAA0CR,MAA1C,EAAkDQ,KAAlD,CAAwD,UAAxD,EAAoEC,IAApE,CAAyER,OAAzE,EACGS,IADH,CAEI,UAACC,IAAD,EAAU,CACT,CAHL,EAKGC,KALH,CAMI,UAACC,KAAD,EAAW;AACTC,QAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACD,OARL;AAUD,KAlBM;AAmBPG,IAAAA,aAnBO,yBAmBQjB,OAnBR,EAmBiB;AACtB,UAAIG,IAAI,GAAGH,OAAO,CAACkB,OAAR,CAAgBf,IAA3B;AACAb,MAAAA,QAAQ,CAACiB,QAAT,GAAoBC,GAApB,CAAwB,OAAxB,EAAiCC,KAAjC,CAAuCN,IAAI,CAACgB,EAA5C,EAAgDV,KAAhD,CAAsD,OAAtD,EAA+DW,YAA/D,CAA4E,WAA5E,EAAyFC,IAAzF,CAA8F,OAA9F,EAAuG,UAASC,QAAT,EAAmB;AACxH,YAAI7B,KAAK,GAAG6B,QAAQ,CAACC,GAAT,EAAZ;;AACA,YAAG9B,KAAK,IAAI,IAAZ,EAAkB;AAChBA,UAAAA,KAAK,GAAG,EAAR;AACD;;AAJuH,mCAMhH+B,MANgH;AAOtH/B,UAAAA,KAAK,CAAC+B,MAAD,CAAL,CAAc3B,IAAd,GAAqB,YAArB;AACAP,UAAAA,QAAQ,CAACiB,QAAT,GAAoBC,GAApB,CAAwB,OAAxB,EAAiCC,KAAjC,CAAuCe,MAAvC,EAA+CH,IAA/C,CAAoD,OAApD,EAA6D,UAAUC,QAAV,EAAoB;AAC/E7B,YAAAA,KAAK,CAAC+B,MAAD,CAAL,CAAc3B,IAAd,GAAqByB,QAAQ,CAACC,GAAT,GAAe1B,IAApC;AACAG,YAAAA,OAAO,CAACyB,MAAR,CAAe,UAAf,EAA2BhC,KAA3B;AACD,WAHD;AARsH;;AAMxH,aAAI,IAAI+B,MAAR,IAAkB/B,KAAlB,EAAyB;AAAA,gBAAjB+B,MAAiB;AAMxB;AACF,OAbD;AAcD;AAnCM,GAVQ;AA+CjBN,EAAAA,OAAO,EAAE;AACPzB,IAAAA,KADO,iBACAD,KADA,EACO;AACZ,aAAOA,KAAK,CAACC,KAAb;AACD;AAHM;AA/CQ,CAAnB;AAsDA,eAAeF,UAAf","sourcesContent":["import * as firebase from 'firebase'\r\n\r\nconst ChatModule = {\r\n  state: {\r\n    chats: {}\r\n  },\r\n  mutations: {\r\n    setChats (state, payload) {\r\n      payload[\"0\"] = {name: \"Default\"}\r\n      state.chats = payload\r\n    }\r\n  },\r\n  actions: {\r\n    sendMessage (context, payload) {\r\n      let chatID = payload.chatID\r\n      const message = {\r\n        user: payload.username,\r\n        content: payload.content,\r\n        date: payload.date\r\n      }\r\n      firebase.database().ref('messages').child(chatID).child('messages').push(message)\r\n        .then(\r\n          (data) => {\r\n          }\r\n        )\r\n        .catch(\r\n          (error) => {\r\n            console.log(error)\r\n          }\r\n        )\r\n    },\r\n    loadUserChats (context) {\r\n      let user = context.getters.user\r\n      firebase.database().ref('users').child(user.id).child('chats').orderByChild(\"timestamp\").once(\"value\", function(snapshot) {\r\n        let chats = snapshot.val()\r\n        if(chats == null) {\r\n          chats = {}\r\n        }\r\n\r\n        for(let chatId in chats) {\r\n          chats[chatId].name = \"Loading...\"\r\n          firebase.database().ref('chats').child(chatId).once('value', function (snapshot) {\r\n            chats[chatId].name = snapshot.val().name\r\n            context.commit('setChats', chats)\r\n          })\r\n        }\r\n      })\r\n    }\r\n  },\r\n  getters: {\r\n    chats (state) {\r\n      return state.chats\r\n    }\r\n  }\r\n}\r\n\r\nexport default ChatModule\r\n"]}]}