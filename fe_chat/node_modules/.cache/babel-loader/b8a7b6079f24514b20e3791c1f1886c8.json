{"remainingRequest":"C:\\SSAFY\\git\\s03p23b304\\fe_chat\\node_modules\\babel-loader\\lib\\index.js!C:\\SSAFY\\git\\s03p23b304\\fe_chat\\src\\store\\AuthModule.js","dependencies":[{"path":"C:\\SSAFY\\git\\s03p23b304\\fe_chat\\src\\store\\AuthModule.js","mtime":1600910340547},{"path":"C:\\SSAFY\\git\\s03p23b304\\fe_chat\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\SSAFY\\git\\s03p23b304\\fe_chat\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICogYXMgZmlyZWJhc2UgZnJvbSAnZmlyZWJhc2UnOwp2YXIgQXV0aE1vZHVsZSA9IHsKICBzdGF0ZTogewogICAgdXNlcjogbnVsbAogIH0sCiAgbXV0YXRpb25zOiB7CiAgICBzZXRVc2VyOiBmdW5jdGlvbiBzZXRVc2VyKHN0YXRlLCBwYXlsb2FkKSB7CiAgICAgIHN0YXRlLnVzZXIgPSBwYXlsb2FkOwogICAgICB2YXIgdXNlckxpc3RSZWYgPSBmaXJlYmFzZS5kYXRhYmFzZSgpLnJlZigncHJlc2VuY2UnKTsKICAgICAgdmFyIG15VXNlclJlZiA9IHVzZXJMaXN0UmVmLnB1c2goKTsKICAgICAgZmlyZWJhc2UuZGF0YWJhc2UoKS5yZWYoJy5pbmZvL2Nvbm5lY3RlZCcpLm9uKCd2YWx1ZScsIGZ1bmN0aW9uIChzbmFwKSB7CiAgICAgICAgaWYgKHNuYXAudmFsKCkpIHsKICAgICAgICAgIC8vIGlmIHdlIGxvc2UgbmV0d29yayB0aGVuIHJlbW92ZSB0aGlzIHVzZXIgZnJvbSB0aGUgbGlzdAogICAgICAgICAgbXlVc2VyUmVmLm9uRGlzY29ubmVjdCgpLnJlbW92ZSgpOyAvLyBzZXQgdXNlcidzIG9ubGluZSBzdGF0dXMKCiAgICAgICAgICB2YXIgcHJlc2VuY2VPYmplY3QgPSB7CiAgICAgICAgICAgIHVzZXI6IHBheWxvYWQsCiAgICAgICAgICAgIHN0YXR1czogJ29ubGluZScKICAgICAgICAgIH07CiAgICAgICAgICBteVVzZXJSZWYuc2V0KHByZXNlbmNlT2JqZWN0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gY2xpZW50IGhhcyBsb3N0IG5ldHdvcmsKICAgICAgICAgIHZhciBfcHJlc2VuY2VPYmplY3QgPSB7CiAgICAgICAgICAgIHVzZXI6IHBheWxvYWQsCiAgICAgICAgICAgIHN0YXR1czogJ29mZmxpbmUnCiAgICAgICAgICB9OwogICAgICAgICAgbXlVc2VyUmVmLnNldChfcHJlc2VuY2VPYmplY3QpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwKICBhY3Rpb25zOiB7CiAgICBzaWduVXNlclVwOiBmdW5jdGlvbiBzaWduVXNlclVwKF9yZWYsIHBheWxvYWQpIHsKICAgICAgdmFyIGNvbW1pdCA9IF9yZWYuY29tbWl0OwogICAgICBjb21taXQoJ3NldExvYWRpbmcnLCB0cnVlKTsKICAgICAgY29tbWl0KCdjbGVhckVycm9yJyk7CiAgICAgIGZpcmViYXNlLmF1dGgoKS5jcmVhdGVVc2VyV2l0aEVtYWlsQW5kUGFzc3dvcmQocGF5bG9hZC5lbWFpbCwgcGF5bG9hZC5wYXNzd29yZCkudGhlbihmdW5jdGlvbiAoYXV0aCkgewogICAgICAgIGZpcmViYXNlLmRhdGFiYXNlKCkucmVmKCd1c2VycycpLmNoaWxkKGF1dGgudXNlci51aWQpLnNldCh7CiAgICAgICAgICBuYW1lOiBwYXlsb2FkLnVzZXJuYW1lCiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAobWVzc2FnZSkgewogICAgICAgICAgY29tbWl0KCdzZXRMb2FkaW5nJywgZmFsc2UpOwogICAgICAgICAgdmFyIG5ld1VzZXIgPSB7CiAgICAgICAgICAgIGlkOiBhdXRoLnVzZXIudWlkLAogICAgICAgICAgICB1c2VybmFtZTogcGF5bG9hZC51c2VybmFtZQogICAgICAgICAgfTsKICAgICAgICAgIGNvbW1pdCgnc2V0VXNlcicsIG5ld1VzZXIpOwogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgY29tbWl0KCdzZXRMb2FkaW5nJywgZmFsc2UpOwogICAgICAgICAgY29tbWl0KCdzZXRFcnJvcicsIGVycm9yKTsKICAgICAgICB9KTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgY29tbWl0KCdzZXRMb2FkaW5nJywgZmFsc2UpOwogICAgICAgIGNvbW1pdCgnc2V0RXJyb3InLCBlcnJvcik7CiAgICAgIH0pOwogICAgfSwKICAgIHNpZ25Vc2VySW46IGZ1bmN0aW9uIHNpZ25Vc2VySW4oX3JlZjIsIHBheWxvYWQpIHsKICAgICAgdmFyIGNvbW1pdCA9IF9yZWYyLmNvbW1pdDsKICAgICAgY29tbWl0KCdzZXRMb2FkaW5nJywgdHJ1ZSk7CiAgICAgIGNvbW1pdCgnY2xlYXJFcnJvcicpOwogICAgICBmaXJlYmFzZS5hdXRoKCkuc2lnbkluV2l0aEVtYWlsQW5kUGFzc3dvcmQocGF5bG9hZC5lbWFpbCwgcGF5bG9hZC5wYXNzd29yZCkudGhlbihmdW5jdGlvbiAoYXV0aCkgewogICAgICAgIGZpcmViYXNlLmRhdGFiYXNlKCkucmVmKCd1c2VycycpLmNoaWxkKGF1dGgudXNlci51aWQpLm9uY2UoJ3ZhbHVlJywgZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgIGNvbW1pdCgnc2V0TG9hZGluZycsIGZhbHNlKTsKICAgICAgICAgIHZhciBuZXdVc2VyID0gewogICAgICAgICAgICBpZDogYXV0aC51c2VyLnVpZCwKICAgICAgICAgICAgdXNlcm5hbWU6IGF1dGgudXNlci5lbWFpbAogICAgICAgICAgfTsKICAgICAgICAgIGNvbW1pdCgnc2V0VXNlcicsIG5ld1VzZXIpOwogICAgICAgIH0pOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICBjb21taXQoJ3NldExvYWRpbmcnLCBmYWxzZSk7CiAgICAgICAgY29tbWl0KCdzZXRFcnJvcicsIGVycm9yKTsKICAgICAgfSk7CiAgICB9CiAgfSwKICBnZXR0ZXJzOiB7CiAgICB1c2VyOiBmdW5jdGlvbiB1c2VyKHN0YXRlKSB7CiAgICAgIHJldHVybiBzdGF0ZS51c2VyOwogICAgfQogIH0KfTsKZXhwb3J0IGRlZmF1bHQgQXV0aE1vZHVsZTs="},{"version":3,"sources":["C:/SSAFY/git/s03p23b304/fe_chat/src/store/AuthModule.js"],"names":["firebase","AuthModule","state","user","mutations","setUser","payload","userListRef","database","ref","myUserRef","push","on","snap","val","onDisconnect","remove","presenceObject","status","set","actions","signUserUp","commit","auth","createUserWithEmailAndPassword","email","password","then","child","uid","name","username","message","newUser","id","catch","error","signUserIn","signInWithEmailAndPassword","once","data","getters"],"mappings":"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","sourcesContent":["import * as firebase from 'firebase'\r\n\r\nconst AuthModule = {\r\n  state: {\r\n    user: null\r\n  },\r\n  mutations: {\r\n    setUser (state, payload) {\r\n      state.user = payload\r\n      const userListRef = firebase.database().ref('presence')\r\n      const myUserRef = userListRef.push()\r\n\r\n      firebase.database().ref('.info/connected')\r\n        .on(\r\n          'value', function (snap) {\r\n            if (snap.val()) {\r\n              // if we lose network then remove this user from the list\r\n              myUserRef.onDisconnect()\r\n                .remove()\r\n              // set user's online status\r\n              let presenceObject = {user: payload, status: 'online'}\r\n              myUserRef.set(presenceObject)\r\n            } else {\r\n              // client has lost network\r\n              let presenceObject = {user: payload, status: 'offline'}\r\n              myUserRef.set(presenceObject)\r\n            }\r\n          }\r\n        )\r\n    }\r\n  },\r\n  actions: {\r\n    signUserUp ({commit}, payload) {\r\n      commit('setLoading', true)\r\n      commit('clearError')\r\n      firebase.auth().createUserWithEmailAndPassword(payload.email, payload.password)\r\n        .then(\r\n          auth => {\r\n            firebase.database().ref('users').child(auth.user.uid).set({\r\n              name: payload.username\r\n            })\r\n              .then(\r\n                message => {\r\n                  commit('setLoading', false)\r\n                  const newUser = {\r\n                    id: auth.user.uid,\r\n                    username: payload.username\r\n                  }\r\n                  commit('setUser', newUser)\r\n                }\r\n              )\r\n              .catch(\r\n                error => {\r\n                  commit('setLoading', false)\r\n                  commit('setError', error)\r\n                }\r\n              )\r\n          }\r\n        )\r\n        .catch(\r\n          error => {\r\n            commit('setLoading', false)\r\n            commit('setError', error)\r\n          }\r\n        )\r\n    },\r\n    signUserIn ({commit}, payload) {\r\n      commit('setLoading', true)\r\n      commit('clearError')\r\n      firebase.auth().signInWithEmailAndPassword(payload.email, payload.password)\r\n        .then(\r\n          auth => {\r\n            firebase.database().ref('users').child(auth.user.uid).once('value', function (data) {\r\n              commit('setLoading', false)\r\n              const newUser = {\r\n                id: auth.user.uid,\r\n                username: auth.user.email\r\n              }\r\n              commit('setUser', newUser)\r\n            })\r\n          }\r\n        )\r\n        .catch(\r\n          error => {\r\n            commit('setLoading', false)\r\n            commit('setError', error)\r\n          }\r\n        )\r\n    }\r\n  },\r\n  getters: {\r\n    user (state) {\r\n      return state.user\r\n    }\r\n  }\r\n}\r\n\r\nexport default AuthModule\r\n"]}]}